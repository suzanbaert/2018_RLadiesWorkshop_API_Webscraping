<!DOCTYPE html>
<html>
  <head>
    <title>Working with web data</title>
    <meta charset="utf-8">
    <meta name="author" content="Suzan Baert" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="css\my-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">




---


# Webscraping Etiquette

1. If there is a public API available, use the API and don't scrape the info

2. Always check with `robotstxt` or `polite` whether you are allowed to scrape a page

3. Build system sleeps into your API or scraping requests

4. Don't gather data you won't need

5. Keep away from gathering PII (personal identifiable) data


---

class: left, middle

background-image: url(images/laptop-background.jpg)
background-size: cover

# Part 1: API

---

# What is an API?

.center[API = Application Programming Interface  
"a set of subroutine definitions, communication protocols, and tools for building software"]

--

&lt;br&gt;

.center.handwritten[HUH ???]

--

&lt;br&gt;&lt;br&gt;

### Examples:  
- Travel websites getting info on flight schedule and prices
- Getting fonts for your website (or this presentation) through Google Fonts API 
- Getting tweets with the hashtag #rstats via Twitter API
- ...

---

# API communication

Communication with HTTP request methods.  
Two most common ones:

--

.pull-left[
## GET requests
Asking the API for something
```
library(httr)
response &lt;- GET(url)
content(response)
```

]

--

.pull-right[
## POST requests
Giving something to the API
```
library(httr)
response &lt;- POST(url, body)
content(response)
```

]


---

# API output

Two general formats for API responses.
+ Both are plain text formats to exchange data
+ Most API's these days are JSON


.pull-left[
### JSON
Javascript Object Notation

```
{"employees":[
    {"firstName":"John", "lastName":"Doe"},
    {"firstName":"Anna", "lastName":"Smith"},
    {"firstName":"Peter", "lastName":"Jones"}
]}
```
]

--

.pull-right[
### XML
Extensible Markup Language

```
&lt;employees&gt;
    &lt;employee&gt;
        &lt;firstName&gt;John&lt;/firstName&gt; 
        &lt;lastName&gt;Doe&lt;/lastName&gt;
    &lt;/employee&gt;
    &lt;employee&gt;
        &lt;firstName&gt;Anna&lt;/firstName&gt; 
        &lt;lastName&gt;Smith&lt;/lastName&gt;
    &lt;/employee&gt;
    &lt;employee&gt;
        &lt;firstName&gt;Peter&lt;/firstName&gt; 
        &lt;lastName&gt;Jones&lt;/lastName&gt;
    &lt;/employee&gt;
&lt;/employees&gt;
```
]

---

# A quick intro to JSON

Two basic forms:
+ JSON object: `{"key": "value"}`
+ JSON array: `[1, 2, 3]` or `["a", "b", "c"]`

--

Building hierarchies
+ The value of a JSON object can be another JSON object or array
+ The values in a JSON array can be another JSON object or array

--

For R users:
+ JSON object ~ named value
+ JSON array ~ named vector

---

# A quick intro to JSON

`jsonlite::prettify()` to make a more human readable JSON


```r
library(jsonlite)

json_object &lt;- '{"organization" : "R-Ladies", "chapter": "Brussels", "start_year": 2017, "active": true, "organizers": ["Marlene", "Huong", "Suzan"]}'
prettify(json_object)
```

```
## {
##     "organization": "R-Ladies",
##     "chapter": "Brussels",
##     "start_year": 2017,
##     "active": true,
##     "organizers": [
##         "Marlene",
##         "Huong",
##         "Suzan"
##     ]
## }
## 
```


---

# A quick intro to JSON

`jsonlite::fromJSON()` to parse JSON to R



```r
library(jsonlite)
fromJSON(json_object)
```

```
## $organization
## [1] "R-Ladies"
## 
## $chapter
## [1] "Brussels"
## 
## $start_year
## [1] 2017
## 
## $active
## [1] TRUE
## 
## $organizers
## [1] "Marlene" "Huong"   "Suzan"
```

---

background-image: url(images/API_workflow.png)
background-position: 50% 60%
background-size: 1200px


---

# Easy example: ISS position

![](images/API1_ISS.png)

---

background-image: url(images/API_workflow_icon1.png)
background-position: 100% 0%
background-size: 200px


# Easy example: ISS position

Step 1: Preparation:


```r
url &lt;- "http://api.open-notify.org/iss-now.json"
```


---

background-image: url(images/API_workflow_icon2.png)
background-position: 100% 0%
background-size: 200px

# Easy example: ISS position


Step 2: GET request:

```r
library(httr)
response_iss &lt;- GET(url)
response_iss
```

```
## Response [http://api.open-notify.org/iss-now.json]
##   Date: 2018-09-25 16:50
##   Status: 200
##   Content-Type: application/json
##   Size: 115 B
```

--

*Status codes:*
+ 200: OK
+ 400-499: your code is missing something
+ 500-599: something is off on our end


---

background-image: url(images/API_workflow_icon3.png)
background-position: 100% 0%
background-size: 200px

# Easy example: ISS position

Step 3: Extract and parse the response


```r
content_iss &lt;- content(response_iss)
content_iss
```

```
## $message
## [1] "success"
## 
## $timestamp
## [1] 1537894205
## 
## $iss_position
## $iss_position$latitude
## [1] "-51.3493"
## 
## $iss_position$longitude
## [1] "-117.1048"
```


---

background-image: url(images/API_workflow_icon3.png)
background-position: 100% 0%
background-size: 200px

# Easy example: ISS position

Step 4: Data wrangling in R


```r
ISS_position &lt;- data.frame(
  time = content_iss$timestamp,
  lat = content_iss$iss_position$latitude,
  long = content_iss$iss_position$longitude)

ISS_position
```

```
##         time      lat      long
## 1 1537894205 -51.3493 -117.1048
```

---

background-image: url(images/API_workflow_R.png)
background-position: 50% 60%
background-size: 1200px



---

background-image: url(images/API_workflow_icon1.png)
background-position: 100% 0%
background-size: 200px


# Prepare your request: URL-building


Read the documentation: every API is different

+ Directory based URLs: `url/api/directory1/directory2`

+ Parameter based URLs: `url/api?param1=value1&amp;param2=value2`

+ Or a combination of both: `url/api/directory1?param1=value`

--

### Examples:

Github: `https://api.github.com/repos/vmg/redcarpet/issues?state=closed`

Star Wars API: `https://swapi.co/api/planets`

Game of Thrones API: `https://www.anapioficeandfire.com/api/characters?page=1&amp;pageSize=10`


---

background-image: url(images/API_workflow_icon1.png)
background-position: 100% 0%
background-size: 200px


# Prepare your request: URL-building

+ Option 1: Manual copy paste:

```r
url &lt;- "http://api.website.com/directory1?param1=value1&amp;param2=value2"
```


+ Option 2: Pasting together:

```r
url1 &lt;- paste("http://api.website.com", directory1, sep = "/")

url2 &lt;- paste0("http://api.website.com/directory1?param1=", value1,
              "&amp;param2=", value2)
```

+ Option 3: Modifying url

```r
url &lt;- modify_url(url = "http://api.website.com",
                  path = "directory1",
                  query = list(param1 = "value1", param2 = "value2"))
```

              
---

background-image: url(images/API_workflow_icon1.png)
background-position: 100% 0%
background-size: 200px


# Prepare your request: Authentication

Different types of authentication exists: 
+ username/password via `authenticate()`
+ OAuth 1.0 via `oauth_app()` and `oauth1.0_token`
+ OAuth 2.0 via `oauth_app()` and `oauth2.0_token`

How to get access? 
+ Follow the documentation
+ Follow demo's: [https://github.com/r-lib/httr/tree/master/demo](https://github.com/r-lib/httr/tree/master/demo)

---

background-image: url(images/API_workflow_icon2.png)
background-position: 100% 0%
background-size: 200px


# Step 2: GET request

Basic structure:

```
library(httr)
response &lt;- GET(url, 
                query = query_params,
                authenticate("username", "password"))
```
+ URL: base URL or full URL assembled before
+ optional: query with a list of query paramaters if not added to url yet
+ optional: authenticate


---

background-image: url(images/API_workflow_icon3.png)
background-position: 100% 0%
background-size: 200px


# Step 3: Extract and parse the response

```
library(httr)
content &lt;- content(response)
```

By default, httr::content() automatically parses to R
+ if JSON: using jsonlite::fromJSON()
+ if XML: using xml2::read_xml()

Alternative options:
+ `content(response, as = "text")`: extracts without parsing


---

background-image: url(images/API_workflow_icon4.png)
background-position: 100% 0%
background-size: 200px


# Step 4: Data wranging in R

Use all your list tools to get your data in the shape you need it:
- purrr
- dplyr
- rlist
- ...


---

# Repeated API calls

+ Wrap your code in a function
+ Build a sys.Sleep() between iterations!


---

# Your turn: Example 1

Get the five next ISS passes above Brussels

### API Documentation: 
http://open-notify.org/Open-Notify-API/ISS-Pass-Times/


### Coordinates brussels
lat_bxl &lt;- 50.85045
long_bxl &lt;- 4.34878


---

# Your turn: solution example 1


```r
lat_bxl &lt;- 50.85045
long_bxl &lt;- 4.34878

#manual
url &lt;- "http://api.open-notify.org/iss-pass.json?lat=50.85045&amp;lon=4.34878"

#paste together
url2 &lt;- paste0("http://api.open-notify.org/iss-pass.json?lat=", lat_bxl, "&amp;lon=", long_bxl)

#build URL
url3 &lt;- httr::modify_url(url = "http://api.open-notify.org",
                  path = "iss-pass.json",
                  query = list(lat = lat_bxl, lon = long_bxl))
```

---

# Your turn: solution example 1


```r
#GET request
response &lt;- GET(url3)

#unpack response
content &lt;- content(response)

#modify to R
pass_times &lt;- data.frame(
  risetime = purrr::map_chr(content$response, "risetime"),
  duration = purrr::map_chr(content$response, "duration"))
```



---

# Your turn: Example 2

an API of Ice and Fire: www.anapioficeandfire.com

+ Get the info on all the books
+ Find all book names
+ Extract the POV (point of view characters) from book 1
+ Ask the API for info on all pov characters from book 1



---

# Your turn: solution example 2

Getting the info on all books


```r
library(httr)
url &lt;- "https://www.anapioficeandfire.com/api/books"
response_books &lt;- GET(url)
content_books &lt;- content(response_books)

#look into the book 
str(content_books, max.level = 2)
```

```
## List of 10
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/1"
##   ..$ name         : chr "A Game of Thrones"
##   ..$ isbn         : chr "978-0553103540"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 694
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "1996-08-01T00:00:00"
##   ..$ characters   :List of 434
##   ..$ povCharacters:List of 9
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/2"
##   ..$ name         : chr "A Clash of Kings"
##   ..$ isbn         : chr "978-0553108033"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 768
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardback"
##   ..$ released     : chr "1999-02-02T00:00:00"
##   ..$ characters   :List of 778
##   ..$ povCharacters:List of 10
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/3"
##   ..$ name         : chr "A Storm of Swords"
##   ..$ isbn         : chr "978-0553106633"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 992
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2000-10-31T00:00:00"
##   ..$ characters   :List of 1021
##   ..$ povCharacters:List of 12
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/4"
##   ..$ name         : chr "The Hedge Knight"
##   ..$ isbn         : chr "978-0976401100"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 164
##   ..$ publisher    : chr "Dabel Brothers Publishing"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "GraphicNovel"
##   ..$ released     : chr "2005-03-09T00:00:00"
##   ..$ characters   :List of 54
##   ..$ povCharacters:List of 1
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/5"
##   ..$ name         : chr "A Feast for Crows"
##   ..$ isbn         : chr "978-0553801507"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 784
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United Status"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2005-11-08T00:00:00"
##   ..$ characters   :List of 1241
##   ..$ povCharacters:List of 12
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/6"
##   ..$ name         : chr "The Sworn Sword"
##   ..$ isbn         : chr "978-0785126508"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 152
##   ..$ publisher    : chr "Marvel"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2008-06-18T00:00:00"
##   ..$ characters   :List of 84
##   ..$ povCharacters:List of 1
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/7"
##   ..$ name         : chr "The Mystery Knight"
##   ..$ isbn         : chr "978-0765360267"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 416
##   ..$ publisher    : chr "Tor Fantasy"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Paperback"
##   ..$ released     : chr "2011-03-29T00:00:00"
##   ..$ characters   :List of 71
##   ..$ povCharacters:List of 1
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/8"
##   ..$ name         : chr "A Dance with Dragons"
##   ..$ isbn         : chr "978-0553801477"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 1040
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2011-07-12T00:00:00"
##   ..$ characters   :List of 861
##   ..$ povCharacters:List of 18
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/9"
##   ..$ name         : chr "The Princess and the Queen"
##   ..$ isbn         : chr "978-0765332066"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 784
##   ..$ publisher    : chr "Tor Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2013-12-03T00:00:00"
##   ..$ characters   :List of 57
##   ..$ povCharacters: list()
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/10"
##   ..$ name         : chr "The Rogue Prince"
##   ..$ isbn         : chr "978-0345537263"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 832
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2014-06-17T00:00:00"
##   ..$ characters   :List of 55
##   ..$ povCharacters: list()
```


---


# Your turn: solution example 2

Getting the info on all books


```r
library(httr)
url &lt;- "https://www.anapioficeandfire.com/api/books"
response_books &lt;- GET(url)
content_books &lt;- content(response_books)

#look into the book 
str(content_books, max.level = 2)
```

```
## List of 10
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/1"
##   ..$ name         : chr "A Game of Thrones"
##   ..$ isbn         : chr "978-0553103540"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 694
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "1996-08-01T00:00:00"
##   ..$ characters   :List of 434
##   ..$ povCharacters:List of 9
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/2"
##   ..$ name         : chr "A Clash of Kings"
##   ..$ isbn         : chr "978-0553108033"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 768
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardback"
##   ..$ released     : chr "1999-02-02T00:00:00"
##   ..$ characters   :List of 778
##   ..$ povCharacters:List of 10
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/3"
##   ..$ name         : chr "A Storm of Swords"
##   ..$ isbn         : chr "978-0553106633"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 992
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2000-10-31T00:00:00"
##   ..$ characters   :List of 1021
##   ..$ povCharacters:List of 12
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/4"
##   ..$ name         : chr "The Hedge Knight"
##   ..$ isbn         : chr "978-0976401100"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 164
##   ..$ publisher    : chr "Dabel Brothers Publishing"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "GraphicNovel"
##   ..$ released     : chr "2005-03-09T00:00:00"
##   ..$ characters   :List of 54
##   ..$ povCharacters:List of 1
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/5"
##   ..$ name         : chr "A Feast for Crows"
##   ..$ isbn         : chr "978-0553801507"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 784
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United Status"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2005-11-08T00:00:00"
##   ..$ characters   :List of 1241
##   ..$ povCharacters:List of 12
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/6"
##   ..$ name         : chr "The Sworn Sword"
##   ..$ isbn         : chr "978-0785126508"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 152
##   ..$ publisher    : chr "Marvel"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2008-06-18T00:00:00"
##   ..$ characters   :List of 84
##   ..$ povCharacters:List of 1
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/7"
##   ..$ name         : chr "The Mystery Knight"
##   ..$ isbn         : chr "978-0765360267"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 416
##   ..$ publisher    : chr "Tor Fantasy"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Paperback"
##   ..$ released     : chr "2011-03-29T00:00:00"
##   ..$ characters   :List of 71
##   ..$ povCharacters:List of 1
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/8"
##   ..$ name         : chr "A Dance with Dragons"
##   ..$ isbn         : chr "978-0553801477"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 1040
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2011-07-12T00:00:00"
##   ..$ characters   :List of 861
##   ..$ povCharacters:List of 18
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/9"
##   ..$ name         : chr "The Princess and the Queen"
##   ..$ isbn         : chr "978-0765332066"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 784
##   ..$ publisher    : chr "Tor Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2013-12-03T00:00:00"
##   ..$ characters   :List of 57
##   ..$ povCharacters: list()
##  $ :List of 11
##   ..$ url          : chr "https://www.anapioficeandfire.com/api/books/10"
##   ..$ name         : chr "The Rogue Prince"
##   ..$ isbn         : chr "978-0345537263"
##   ..$ authors      :List of 1
##   ..$ numberOfPages: int 832
##   ..$ publisher    : chr "Bantam Books"
##   ..$ country      : chr "United States"
##   ..$ mediaType    : chr "Hardcover"
##   ..$ released     : chr "2014-06-17T00:00:00"
##   ..$ characters   :List of 55
##   ..$ povCharacters: list()
```


---

# Your turn: solution example 2

Find all book names


```r
purrr::map_chr(content_books, "name")
```

```
##  [1] "A Game of Thrones"          "A Clash of Kings"          
##  [3] "A Storm of Swords"          "The Hedge Knight"          
##  [5] "A Feast for Crows"          "The Sworn Sword"           
##  [7] "The Mystery Knight"         "A Dance with Dragons"      
##  [9] "The Princess and the Queen" "The Rogue Prince"
```


---

# Your turn: solution example 2

Extract the POV (point of view characters) from book 1



```r
content_book1 &lt;- content_books[[1]]
book1_pov &lt;- content_book1$povCharacters
book1_pov &lt;- unlist(book1_pov)
book1_pov
```

```
## [1] "https://www.anapioficeandfire.com/api/characters/148" 
## [2] "https://www.anapioficeandfire.com/api/characters/208" 
## [3] "https://www.anapioficeandfire.com/api/characters/232" 
## [4] "https://www.anapioficeandfire.com/api/characters/339" 
## [5] "https://www.anapioficeandfire.com/api/characters/583" 
## [6] "https://www.anapioficeandfire.com/api/characters/957" 
## [7] "https://www.anapioficeandfire.com/api/characters/1052"
## [8] "https://www.anapioficeandfire.com/api/characters/1109"
## [9] "https://www.anapioficeandfire.com/api/characters/1303"
```


---

# Your turn: solution example 2

Call the API for info on first character


```r
url1 &lt;- book1_pov[1]
response &lt;- GET(url1)
content &lt;- content(response)

data.frame(name = content$name,
  gender = content$gender,
  culture = content$culture,
  born = content$born,
  died = content$died)
```

```
##         name gender  culture                     born died
## 1 Arya Stark Female Northmen In 289 AC, at Winterfell
```

---

# Your turn: solution example 2

Wrap it inside a function:


```r
get_pov_info &lt;- function(url) {
  response &lt;- GET(url)
  content &lt;- content(response)
  
  df &lt;- data.frame(
    name = content$name,
    gender = content$gender,
    culture = content$culture,
    born = content$born,
    died = content$died, stringsAsFactors = FALSE)
  
  Sys.sleep(1)
  
  df
}
```


---

# Your turn: solution example 2


```r
all_pov_info &lt;- purrr::map_df(book1_pov, get_pov_info)
all_pov_info
```


```
##                 name gender  culture                        born
## 1         Arya Stark Female Northmen    In 289 AC, at Winterfell
## 2      Brandon Stark   Male Northmen    In 290 AC, at Winterfell
## 3      Catelyn Stark Female Rivermen      In 264 AC, at Riverrun
## 4       Eddard Stark   Male Northmen    In 263 AC, at Winterfell
## 5           Jon Snow   Male Northmen                   In 283 AC
## 6        Sansa Stark Female Northmen    In 286 AC, at Winterfell
## 7   Tyrion Lannister   Male          In 273 AC, at Casterly Rock
## 8               Will   Male                                     
## 9 Daenerys Targaryen Female Valyrian   In 284 AC, at Dragonstone
##                                                   died
## 1                                                     
## 2                                                     
## 3                              In 299 AC, at the Twins
## 4 In 299 AC, at Great Sept of Baelor in King's Landing
## 5                                                     
## 6                                                     
## 7                                                     
## 8                         In 297 AC, at Haunted Forest
## 9
```


---

# Final word in APIs...

&lt;br&gt;&lt;br&gt;&lt;br&gt;

.center[
## Make you life easy: 
## If a package already exists: use it!]

---

class: left, middle

background-image: url(images/laptop-background.jpg)
background-size: cover

# Part 2: Webscraping

---



---

# Basics of HTML and CSS selectors

+ HTML = Hypertext Markup Language
+ Describes the structure of Web pages
+ Consists of *elements*:

.center[ &lt;tag&gt; content &lt;/tag&gt;]

--

+ Elements can have 1 or more attributes that give additional information:

.center[ &lt;tag attribute_name = "attribute_value"&gt; content &lt;/tag&gt; ]

--

+ Elements can have classes that are coming from CSS

.center[ &lt;tag class = "large"&gt; content &lt;/tag&gt; ]

--

+ Elements can have an id tag (coming from CSS)

.center[ &lt;tag class = "large"&gt; content &lt;/tag&gt; ]


---




































---
# Other Resources

+ Scraping including forms:
https://stat4701.github.io/edav/2015/04/02/rvest_tutorial/
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
